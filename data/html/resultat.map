<!DOCTYPE html>
<html>
<head>
    <title>Resultat previsions</title>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <style type="text/css">
      html, body, #map {
          width: 100%;
          height: 100%;
          margin: 0;
      }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
    <script src="https://www.mapquestapi.com/sdk/leaflet/v2.2/mq-map.js?key=IJIOhD3abkHkZSklL6U1cPxvKaEOdOnX"></script>
    <script>

        function toSexagesimal(dec) {

            var tmp = (Math.abs(dec) + 1.e-9).toString().split('.');

            var deg = tmp[0];
            var min = ('0.' + tmp[1]) * 60;
            var sec = min.toString().split('.');

            min = Math.floor(min);
            sec = (('0.' + sec[1]) * 60).toFixed(0);

            if (sec == 60) {
                sec = 0;
                min++;
            }

            if (min == 60) {
                min = 0;
                deg++;
            }

            return (deg + 'Â° ' + ((min < 10) ? '0' + min : min) + "' " + ((sec < 10) ? '0' + sec : sec) + '"');
        }

        var standard = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors</a>'
        });

        var map = L.map('map', {
		    center: new L.LatLng(LATITUDE_CENTRE, LONGITUDE_CENTRE), zoom: VALEUR_ZOOM,
		    layers: [standard]
	    });

        var marker = new L.marker([LATITUDE_CENTRE, LONGITUDE_CENTRE]).addTo(map);

        var popup = L.popup();

        marker.on('mouseover', function onShowPopup(e) {
                    popup
                .setLatLng(e.latlng)
                .setContent("NOMLIEU_CENTRE<br />CHAINE_LONGITUDE : " + toSexagesimal(e.latlng.lng) + ' ' + ((e.latlng.lng < 0.) ? 'W' : 'E') +
                "<br />CHAINE_LATITUDE : " + toSexagesimal(e.latlng.lat) + ' ' + ((e.latlng.lat < 0.) ? 'S' : 'N') + "<br />CHAINE_ALTITUDE : ALTITUDE_CENTRE")
                .openOn(map);
        });

        map.on('click', function(e) {
                    popup
                .setLatLng(e.latlng)
                .setContent("CHAINE_LONGITUDE : " + toSexagesimal(e.latlng.lng) + ' ' + ((e.latlng.lng < 0.) ? 'W' : 'E') +
                "<br />CHAINE_LATITUDE : " + toSexagesimal(e.latlng.lat) + ' ' + ((e.latlng.lat < 0.) ? 'S' : 'N'))
                .openOn(map);
        });

        L.control.scale({ position: 'topright' }).addTo(map);

        if (LONGITUDE1 != 0. && LATITUDE1 != 0. && LONGITUDE2 != 0. && LATITUDE2 != 0.) {
            L.polygon([
                [LATITUDE1, LONGITUDE1],
                [LATITUDE2, LONGITUDE2]
            ]).addTo(map);
        }

    </script>
</body>
</html>
